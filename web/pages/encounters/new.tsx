import { useEffect, useState } from 'react';
import Layout from '../../components/Layout';
import { api } from '../../lib/api';
export default function NewEncounter(){ const [patients,setPatients]=useState<any[]>([]); const [patientId,setPatientId]=useState(''); const [appointmentId,setAppointmentId]=useState(''); const [desc,setDesc]=useState(''); const [icd,setIcd]=useState(''); const [payment,setPayment]=useState(''); useEffect(()=>{ api('/patients').then(setPatients); },[]); const save=async(e:any)=>{ e.preventDefault(); await api('/encounters',{ method:'POST', body: JSON.stringify({ patient_id: patientId, appointment_id: appointmentId || null, encounter_type: 'KONTROLL', pershkrimi_kontrolles: desc, icd10_code: icd || null, pagesa_eur: payment ? parseFloat(payment) : null }) }); alert('U ruajt'); }; return (<Layout><h2>Dokumentimi i terminit</h2><form onSubmit={save} style={{ display:'grid', gap:8, maxWidth:520 }}><select value={patientId} onChange={e=>setPatientId(e.target.value)} required><option value=''>— Zgjidh pacientin —</option>{patients.map((p:any)=>(<option key={p.id} value={p.id}>{p.firstName} {p.lastName}</option>))}</select><input placeholder='Appointment ID (ops.)' value={appointmentId} onChange={e=>setAppointmentId(e.target.value)} /><textarea placeholder='Përshkrimi i kontrollës' value={desc} onChange={e=>setDesc(e.target.value)} /><input placeholder='ICD-10 (ops.)' value={icd} onChange={e=>setIcd(e.target.value)} /><input placeholder='Pagesa (EUR)' value={payment} onChange={e=>setPayment(e.target.value)} /><button type='submit'>Ruaj</button></form></Layout>); }